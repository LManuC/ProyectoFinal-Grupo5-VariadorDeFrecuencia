\doxysection{Referencia del archivo C\+:/\+Users/\+User/\+Desktop/\+Proyecto\+Final-\/\+Grupo5-\/\+Variador\+De\+Frecuencia/\+Software/\+Firmware stm32/\+Modules/\+Gestor\+\_\+\+Estados/\+Gestor\+Estados.c}
\hypertarget{_gestor_estados_8c}{}\label{_gestor_estados_8c}\index{C:/Users/User/Desktop/ProyectoFinal-\/Grupo5-\/VariadorDeFrecuencia/Software/Firmware stm32/Modules/Gestor\_Estados/GestorEstados.c@{C:/Users/User/Desktop/ProyectoFinal-\/Grupo5-\/VariadorDeFrecuencia/Software/Firmware stm32/Modules/Gestor\_Estados/GestorEstados.c}}


Implementa la máquina de estados del LVFV.  


{\ttfamily \#include "{}Gestor\+Estados.\+h"{}}\newline
{\ttfamily \#include "{}../\+Gestor\+\_\+\+SVM/\+Gestor\+SVM.\+h"{}}\newline
Gráfico de dependencias incluidas en Gestor\+Estados.\+c\+:
% FIG 0
\doxysubsubsection*{Funciones}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{_gestor_estados_8h_a699c67ad6d206290cab4c395cd7d7be7}{System\+Action\+Response}} \mbox{\hyperlink{_gestor_estados_8c_a44b3bf408355270c64323425c66e7719}{Gestor\+Estados\+\_\+\+Action}} (\mbox{\hyperlink{_gestor_estados_8h_aeb5a7529a34b855a5dcc68a6acc1203c}{System\+Action}} sys\+Act, int value)
\begin{DoxyCompactList}\small\item\em Ejecuta una acción de la máquina de estados y devuelve el resultado. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
static \mbox{\hyperlink{_gestor_estados_8h_aa51313be2faacb739a18fdeecefbac75}{System\+State}} \mbox{\hyperlink{_gestor_estados_8c_a7e2bcf8de2c1eced051a3a4d69ec7cee}{current\+State}} = \mbox{\hyperlink{_gestor_estados_8h_aa51313be2faacb739a18fdeecefbac75a98d2a2153b4ae0445fa0b114d65b94d9}{STATE\+\_\+\+INIT}}
\end{DoxyCompactItemize}


\doxysubsection{Descripción detallada}
Implementa la máquina de estados del LVFV. 

Ver \doxylink{_gestor_estados_8h_aa51313be2faacb739a18fdeecefbac75}{System\+State}, \doxylink{_gestor_estados_8h_aeb5a7529a34b855a5dcc68a6acc1203c}{System\+Action} y \doxylink{_gestor_estados_8h_a699c67ad6d206290cab4c395cd7d7be7}{System\+Action\+Response}. 

Definición en el archivo \mbox{\hyperlink{_gestor_estados_8c_source}{Gestor\+Estados.\+c}}.



\label{doc-func-members}
\Hypertarget{_gestor_estados_8c_doc-func-members}
\doxysubsection{Documentación de funciones}
\Hypertarget{_gestor_estados_8c_a44b3bf408355270c64323425c66e7719}\index{GestorEstados.c@{GestorEstados.c}!GestorEstados\_Action@{GestorEstados\_Action}}
\index{GestorEstados\_Action@{GestorEstados\_Action}!GestorEstados.c@{GestorEstados.c}}
\doxysubsubsection{\texorpdfstring{GestorEstados\_Action()}{GestorEstados\_Action()}}
{\footnotesize\ttfamily \label{_gestor_estados_8c_a44b3bf408355270c64323425c66e7719} 
\mbox{\hyperlink{_gestor_estados_8h_a699c67ad6d206290cab4c395cd7d7be7}{System\+Action\+Response}} Gestor\+Estados\+\_\+\+Action (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{_gestor_estados_8h_aeb5a7529a34b855a5dcc68a6acc1203c}{System\+Action}}}]{sys\+Act}{, }\item[{int}]{value}{}\end{DoxyParamCaption})}



Ejecuta una acción de la máquina de estados y devuelve el resultado. 

Evalúa la acción {\ttfamily sys\+Act} contra el estado actual (\doxylink{_gestor_estados_8h_aa51313be2faacb739a18fdeecefbac75}{System\+State}) y, según corresponda, invoca rutinas del SVM (p.\+ej. {\ttfamily \doxylink{_gestor_s_v_m_8c_a0524c323e42d243efaacd375836c2cfb}{Gestor\+SVM\+\_\+\+Motor\+Start()}}, {\ttfamily \doxylink{_gestor_s_v_m_8c_adf2028330d7896b6f9a467dc57d5eac4}{Gestor\+SVM\+\_\+\+Motor\+Stop()}}, {\ttfamily \doxylink{_gestor_s_v_m_8c_a63c6e1ceb949ac408d9516d4cb5be686}{Gestor\+SVM\+\_\+\+Estop()}}, {\ttfamily Gestor\+SVM\+\_\+\+Set\+Frec/\+Set\+Acel/\+Set\+Decel/\+Set\+Dir}) y actualiza la variable interna {\ttfamily \doxylink{_gestor_estados_8c_a7e2bcf8de2c1eced051a3a4d69ec7cee}{current\+State}}. ~\newline
 Las reglas de transición/retorno (según el código mostrado) incluyen, entre otras\+:
\begin{DoxyItemize}
\item \doxylink{_gestor_estados_8h_aeb5a7529a34b855a5dcc68a6acc1203caa867dcd96a811cfb6266aa30addc4195}{ACTION\+\_\+\+INIT\+\_\+\+DONE} \+: solo desde \doxylink{_gestor_estados_8h_aa51313be2faacb739a18fdeecefbac75a98d2a2153b4ae0445fa0b114d65b94d9}{STATE\+\_\+\+INIT} → \doxylink{_gestor_estados_8h_aa51313be2faacb739a18fdeecefbac75aaade5e53e88cf231292cd1142cce2afe}{STATE\+\_\+\+IDLE}.
\item \doxylink{_gestor_estados_8h_aeb5a7529a34b855a5dcc68a6acc1203cad18d9bd6c0a4eced8d31c7b1c6b9dd16}{ACTION\+\_\+\+START} \+: desde \doxylink{_gestor_estados_8h_aa51313be2faacb739a18fdeecefbac75aaade5e53e88cf231292cd1142cce2afe}{STATE\+\_\+\+IDLE} → \doxylink{_gestor_estados_8h_aa51313be2faacb739a18fdeecefbac75a7d453a874f8a1e41a71fa02601836216}{STATE\+\_\+\+VEL\+\_\+\+CHANGE}; si hay movimiento → \doxylink{_gestor_estados_8h_a699c67ad6d206290cab4c395cd7d7be7a7621bc4555e78cd6e80c74bafa7a0283}{ACTION\+\_\+\+RESP\+\_\+\+MOVING}; en emergencia → \doxylink{_gestor_estados_8h_a699c67ad6d206290cab4c395cd7d7be7ac9ce3b2802bf37aac433179ff2874a3e}{ACTION\+\_\+\+RESP\+\_\+\+EMERGENCY\+\_\+\+ACTIVE}.
\item \doxylink{_gestor_estados_8h_aeb5a7529a34b855a5dcc68a6acc1203ca4645d70cb9bb2228f230d601f477639d}{ACTION\+\_\+\+STOP} \+: desde RUNNING/\+VEL\+\_\+\+CHANGE → \doxylink{_gestor_estados_8h_aa51313be2faacb739a18fdeecefbac75a0ee79d8541fe6a143bec1ec4c6b728e0}{STATE\+\_\+\+BRAKING}; en EMERGENCY → \doxylink{_gestor_estados_8h_aa51313be2faacb739a18fdeecefbac75aaade5e53e88cf231292cd1142cce2afe}{STATE\+\_\+\+IDLE}; en IDLE → \doxylink{_gestor_estados_8h_a699c67ad6d206290cab4c395cd7d7be7a81d02313245d29c06a707add990806c6}{ACTION\+\_\+\+RESP\+\_\+\+NOT\+\_\+\+MOVING}.
\item \doxylink{_gestor_estados_8h_aeb5a7529a34b855a5dcc68a6acc1203ca02e4f329c3a2d677cb3e9d9fea2e8e28}{ACTION\+\_\+\+MOTOR\+\_\+\+STOPPED} \+: en BRAKING → \doxylink{_gestor_estados_8h_aa51313be2faacb739a18fdeecefbac75aaade5e53e88cf231292cd1142cce2afe}{STATE\+\_\+\+IDLE}.
\item \doxylink{_gestor_estados_8h_aeb5a7529a34b855a5dcc68a6acc1203cae2752030c8dc2221fdfb8353ef2d7a8a}{ACTION\+\_\+\+EMERGENCY} \+: a \doxylink{_gestor_estados_8h_aa51313be2faacb739a18fdeecefbac75ad0180e0382824e561c72f20f08838420}{STATE\+\_\+\+EMERGENCY} (si no lo estaba).
\item \doxylink{_gestor_estados_8h_aeb5a7529a34b855a5dcc68a6acc1203ca901a803cd622114cffc6ee59403a5c86}{ACTION\+\_\+\+TO\+\_\+\+CONST\+\_\+\+RUNNING} \+: en VEL\+\_\+\+CHANGE → \doxylink{_gestor_estados_8h_aa51313be2faacb739a18fdeecefbac75addfe11c6d06c4e27bd6efc18cc4862a6}{STATE\+\_\+\+RUNNING}.
\item ACTION\+\_\+\+SET\+\_\+\+FREC/\+SET\+\_\+\+ACEL/\+SET\+\_\+\+DESACEL/\+SET\+\_\+\+DIR \+: validan rango/estado y pueden dejar el estado o forzar \doxylink{_gestor_estados_8h_aa51313be2faacb739a18fdeecefbac75a7d453a874f8a1e41a71fa02601836216}{STATE\+\_\+\+VEL\+\_\+\+CHANGE} (según retorno de {\ttfamily Gestor\+SVM\+\_\+\texorpdfstring{$\ast$}{*}}).
\end{DoxyItemize}


\begin{DoxyParams}[1]{Parámetros}
\mbox{\texttt{in}}  & {\em sys\+Act} & Acción solicitada (\doxylink{_gestor_estados_8h_aeb5a7529a34b855a5dcc68a6acc1203c}{System\+Action}). \\
\hline
\mbox{\texttt{in}}  & {\em value} & Parámetro asociado a la acción (p.\+ej., frecuencia, acel./desacel., dirección).\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Devuelve}
\doxylink{_gestor_estados_8h_a699c67ad6d206290cab4c395cd7d7be7}{System\+Action\+Response}
\begin{DoxyItemize}
\item \doxylink{_gestor_estados_8h_a699c67ad6d206290cab4c395cd7d7be7a090da72512b04323631bc989b7ad9e9d}{ACTION\+\_\+\+RESP\+\_\+\+OK} \+: La acción fue válida y se ejecutó (posible cambio de estado).
\item \doxylink{_gestor_estados_8h_a699c67ad6d206290cab4c395cd7d7be7a3197eec44f9da238da4e390c38ae7187}{ACTION\+\_\+\+RESP\+\_\+\+ERR} \+: Secuencia inválida para el estado actual o fallo de configuración.
\item \doxylink{_gestor_estados_8h_a699c67ad6d206290cab4c395cd7d7be7a7621bc4555e78cd6e80c74bafa7a0283}{ACTION\+\_\+\+RESP\+\_\+\+MOVING} \+: Rechazo/indicación de que el motor está en movimiento.
\item \doxylink{_gestor_estados_8h_a699c67ad6d206290cab4c395cd7d7be7a81d02313245d29c06a707add990806c6}{ACTION\+\_\+\+RESP\+\_\+\+NOT\+\_\+\+MOVING} \+: Rechazo/indicación de que el motor está detenido.
\item \doxylink{_gestor_estados_8h_a699c67ad6d206290cab4c395cd7d7be7a55cf7ca3043c85a37a46adae995b6a0b}{ACTION\+\_\+\+RESP\+\_\+\+OUT\+\_\+\+RANGE} \+: Parámetro {\ttfamily value} fuera de límites admitidos.
\item ACTION\+\_\+\+RESP\+\_\+\+EMERGENCY\+\_\+\+ACTIVE\+: Acción no permitida bajo \doxylink{_gestor_estados_8h_aa51313be2faacb739a18fdeecefbac75ad0180e0382824e561c72f20f08838420}{STATE\+\_\+\+EMERGENCY}.
\end{DoxyItemize}
\end{DoxyReturn}
\begin{DoxyNote}{Nota}
Las acciones de lectura (\doxylink{_gestor_estados_8h_aeb5a7529a34b855a5dcc68a6acc1203cac584cfe909986a1a00be92cb2870d63f}{ACTION\+\_\+\+GET\+\_\+\+FREC}, \doxylink{_gestor_estados_8h_aeb5a7529a34b855a5dcc68a6acc1203ca936b4853f8101ae792185c02c4216be0}{ACTION\+\_\+\+GET\+\_\+\+ACEL}, \doxylink{_gestor_estados_8h_aeb5a7529a34b855a5dcc68a6acc1203ca829629e8fda976af81ad64cd9b3f2171}{ACTION\+\_\+\+GET\+\_\+\+DESACEL}, \doxylink{_gestor_estados_8h_aeb5a7529a34b855a5dcc68a6acc1203ca6cf84c7c734fe0fc8d2d79535f1c6374}{ACTION\+\_\+\+GET\+\_\+\+DIR}) no cambian de estado en este switch. 
\end{DoxyNote}
\begin{DoxyWarning}{Atención}
Verificar que cada {\ttfamily case} finalice con {\ttfamily break} (en el código provisto faltaba {\ttfamily break} tras \doxylink{_gestor_estados_8h_aeb5a7529a34b855a5dcc68a6acc1203cae2752030c8dc2221fdfb8353ef2d7a8a}{ACTION\+\_\+\+EMERGENCY} para evitar fall-\/through). 
\end{DoxyWarning}
\begin{DoxyRefDesc}{Tareas pendientes}
\item[\mbox{\hyperlink{todo__todo000001}{Tareas pendientes}}]\+: Aca tengo que poner un timer para que calcule el tiempo aprox de frenado. \end{DoxyRefDesc}


\begin{DoxyRefDesc}{Tareas pendientes}
\item[\mbox{\hyperlink{todo__todo000002}{Tareas pendientes}}]\+: Revisar si es necesario chequear esto ¿\+Por qué no ejecutamos el stop sin importar el estado? \end{DoxyRefDesc}


Definición en la línea \mbox{\hyperlink{_gestor_estados_8c_source_l00012}{12}} del archivo \mbox{\hyperlink{_gestor_estados_8c_source}{Gestor\+Estados.\+c}}.

Gráfico de llamadas de esta función\+:
% FIG 1
Gráfico de llamadas a esta función\+:
% FIG 2


\label{doc-var-members}
\Hypertarget{_gestor_estados_8c_doc-var-members}
\doxysubsection{Documentación de variables}
\Hypertarget{_gestor_estados_8c_a7e2bcf8de2c1eced051a3a4d69ec7cee}\index{GestorEstados.c@{GestorEstados.c}!currentState@{currentState}}
\index{currentState@{currentState}!GestorEstados.c@{GestorEstados.c}}
\doxysubsubsection{\texorpdfstring{currentState}{currentState}}
{\footnotesize\ttfamily \label{_gestor_estados_8c_a7e2bcf8de2c1eced051a3a4d69ec7cee} 
\mbox{\hyperlink{_gestor_estados_8h_aa51313be2faacb739a18fdeecefbac75}{System\+State}} current\+State = \mbox{\hyperlink{_gestor_estados_8h_aa51313be2faacb739a18fdeecefbac75a98d2a2153b4ae0445fa0b114d65b94d9}{STATE\+\_\+\+INIT}}\hspace{0.3cm}{\ttfamily [static]}}



Definición en la línea \mbox{\hyperlink{_gestor_estados_8c_source_l00010}{10}} del archivo \mbox{\hyperlink{_gestor_estados_8c_source}{Gestor\+Estados.\+c}}.

