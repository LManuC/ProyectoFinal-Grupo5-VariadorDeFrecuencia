\doxysection{wifi.\+c}
\hypertarget{wifi_8c_source}{}\label{wifi_8c_source}\index{C:/Users/User/LVFV\_ESP32/main/wifi/wifi.c@{C:/Users/User/LVFV\_ESP32/main/wifi/wifi.c}}
\mbox{\hyperlink{wifi_8c}{Ir a la documentación de este archivo.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00001}00001\ }
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00009}00009\ \textcolor{preprocessor}{\#include\ <stdio.h>}}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00010}00010\ \textcolor{preprocessor}{\#include\ <string.h>}}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00011}00011\ \textcolor{preprocessor}{\#include\ <stdlib.h>}}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00012}00012\ \textcolor{preprocessor}{\#include\ <ctype.h>}}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00013}00013\ }
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00014}00014\ \textcolor{preprocessor}{\#include\ "{}freertos/FreeRTOS.h"{}}}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00015}00015\ \textcolor{preprocessor}{\#include\ "{}freertos/task.h"{}}}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00016}00016\ }
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00017}00017\ \textcolor{preprocessor}{\#include\ "{}esp\_event.h"{}}}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00018}00018\ \textcolor{preprocessor}{\#include\ "{}esp\_log.h"{}}}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00019}00019\ \textcolor{preprocessor}{\#include\ "{}nvs\_flash.h"{}}}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00020}00020\ \textcolor{comment}{//\ \#include\ "{}mdns.h"{}}}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00021}00021\ }
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00022}00022\ \textcolor{preprocessor}{\#include\ "{}esp\_netif.h"{}}}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00023}00023\ }
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00024}00024\ \textcolor{comment}{//\ Tus\ headers\ con\ las\ structs\ y\ funciones:}}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00025}00025\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_l_v_f_v__system_8h}{../LVFV\_system.h}}"{}}}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00026}00026\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{sys_control_8h}{../system/sysControl.h}}"{}}}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00027}00027\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{display_8h}{../display/display.h}}"{}}}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00028}00028\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{wifi_8h}{./wifi.h}}"{}}}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00029}00029\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{form_8h}{form.h}}"{}}}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00030}00030\ }
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00031}\mbox{\hyperlink{wifi_8c_a5a85b9c772bbeb480b209a3e6ea92b4c}{00031}}\ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *\mbox{\hyperlink{adc_8c_a5a85b9c772bbeb480b209a3e6ea92b4c}{TAG}}\ =\ \textcolor{stringliteral}{"{}WEB\_CFG"{}};}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00032}00032\ }
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00033}00033\ \textcolor{comment}{/*\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ Helpers\ para\ parsear\ POST\ x-\/www-\/form-\/urlencoded\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ */}}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00034}00034\ }
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00040}00040\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{wifi_8c_abcaa65247952824272d6e0b91d66cf8b}{hex2int}}(\textcolor{keywordtype}{char}\ c);}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00041}00041\ }
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00049}00049\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{wifi_8c_a3183361e8dc52b9c47fed54863439d4d}{url\_decode}}(\textcolor{keywordtype}{char}\ *dst,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *src);}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00050}00050\ }
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00063}00063\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{wifi_8c_aebcef2c9ac87ea89e0eaed0cb99583e2}{get\_param\_value}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *body,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *key,\ \textcolor{keywordtype}{char}\ *dest,\ \textcolor{keywordtype}{size\_t}\ dest\_len);}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00064}00064\ }
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00070}00070\ \textcolor{keyword}{static}\ esp\_err\_t\ \mbox{\hyperlink{wifi_8c_ad8bb541f65016944ecd059dc8e08f531}{root\_get\_handler}}(httpd\_req\_t\ *req);}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00071}00071\ }
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00089}00089\ \textcolor{keyword}{static}\ esp\_err\_t\ \mbox{\hyperlink{wifi_8c_a7803a9e01b15f01009c423b6e8ebc91a}{save\_post\_handler}}(httpd\_req\_t\ *req);}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00090}00090\ }
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00091}\mbox{\hyperlink{wifi_8c_abcaa65247952824272d6e0b91d66cf8b}{00091}}\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{wifi_8c_abcaa65247952824272d6e0b91d66cf8b}{hex2int}}(\textcolor{keywordtype}{char}\ c)\ \{}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00092}00092\ \ \ \ \ \textcolor{keywordflow}{if}\ (c\ >=\ \textcolor{charliteral}{'0'}\ \&\&\ c\ <=\ \textcolor{charliteral}{'9'})\ \textcolor{keywordflow}{return}\ c\ -\/\ \textcolor{charliteral}{'0'};}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00093}00093\ \ \ \ \ \textcolor{keywordflow}{if}\ (c\ >=\ \textcolor{charliteral}{'a'}\ \&\&\ c\ <=\ \textcolor{charliteral}{'f'})\ \textcolor{keywordflow}{return}\ 10\ +\ (c\ -\/\ \textcolor{charliteral}{'a'});}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00094}00094\ \ \ \ \ \textcolor{keywordflow}{if}\ (c\ >=\ \textcolor{charliteral}{'A'}\ \&\&\ c\ <=\ \textcolor{charliteral}{'F'})\ \textcolor{keywordflow}{return}\ 10\ +\ (c\ -\/\ \textcolor{charliteral}{'A'});}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00095}00095\ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00096}00096\ \}}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00097}00097\ }
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00098}\mbox{\hyperlink{wifi_8c_a3183361e8dc52b9c47fed54863439d4d}{00098}}\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{wifi_8c_a3183361e8dc52b9c47fed54863439d4d}{url\_decode}}(\textcolor{keywordtype}{char}\ *dst,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *src)\ \{}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00099}00099\ \ \ \ \ \textcolor{keywordflow}{while}\ (*src)\ \{}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00100}00100\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (*src\ ==\ \textcolor{charliteral}{'+'})\ \{}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00101}00101\ \ \ \ \ \ \ \ \ \ \ \ \ *dst++\ =\ \textcolor{charliteral}{'\ '};}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00102}00102\ \ \ \ \ \ \ \ \ \ \ \ \ src++;}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00103}00103\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (*src\ ==\ \textcolor{charliteral}{'\%'}\ \&\&\ isxdigit((\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char})src[1])\ \&\&\ isxdigit((\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char})src[2]))\ \{}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00104}00104\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ hi\ =\ \mbox{\hyperlink{wifi_8c_abcaa65247952824272d6e0b91d66cf8b}{hex2int}}(src[1]);}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00105}00105\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ lo\ =\ \mbox{\hyperlink{wifi_8c_abcaa65247952824272d6e0b91d66cf8b}{hex2int}}(src[2]);}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00106}00106\ \ \ \ \ \ \ \ \ \ \ \ \ *dst++\ =\ (char)((hi\ <<\ 4)\ |\ lo);}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00107}00107\ \ \ \ \ \ \ \ \ \ \ \ \ src\ +=\ 3;}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00108}00108\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00109}00109\ \ \ \ \ \ \ \ \ \ \ \ \ *dst++\ =\ *src++;}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00110}00110\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00111}00111\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00112}00112\ \ \ \ \ *dst\ =\ \textcolor{charliteral}{'\(\backslash\)0'};}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00113}00113\ \}}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00114}00114\ }
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00115}\mbox{\hyperlink{wifi_8c_aebcef2c9ac87ea89e0eaed0cb99583e2}{00115}}\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{wifi_8c_aebcef2c9ac87ea89e0eaed0cb99583e2}{get\_param\_value}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *body,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *key,\ \textcolor{keywordtype}{char}\ *dest,\ \textcolor{keywordtype}{size\_t}\ dest\_len)\ \{}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00116}00116\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ key\_len\ =\ strlen(key);}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00117}00117\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *p\ =\ body;}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00118}00118\ }
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00119}00119\ \ \ \ \ \textcolor{keywordflow}{while}\ (p\ \&\&\ *p)\ \{}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00120}00120\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *eq\ =\ strchr(p,\ \textcolor{charliteral}{'='});}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00121}00121\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!eq)\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00122}00122\ }
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00123}00123\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Nombre\ de\ parámetro}}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00124}00124\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ this\_key\_len\ =\ (size\_t)(eq\ -\/\ p);}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00125}00125\ }
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00126}00126\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (this\_key\_len\ ==\ key\_len\ \&\&\ strncmp(p,\ key,\ key\_len)\ ==\ 0)\ \{}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00127}00127\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Encontramos\ la\ clave.\ Buscar\ fin\ del\ valor\ (\&\ o\ final\ de\ cadena)}}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00128}00128\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *val\_start\ =\ eq\ +\ 1;}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00129}00129\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *amp\ =\ strchr(val\_start,\ \textcolor{charliteral}{'\&'});}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00130}00130\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ val\_len\ =\ amp\ ?\ (size\_t)(amp\ -\/\ val\_start)\ :\ strlen(val\_start);}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00131}00131\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (val\_len\ >=\ dest\_len)\ val\_len\ =\ dest\_len\ -\/\ 1;}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00132}00132\ }
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00133}00133\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ encoded[256];}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00134}00134\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (val\_len\ >=\ \textcolor{keyword}{sizeof}(encoded))\ val\_len\ =\ \textcolor{keyword}{sizeof}(encoded)\ -\/\ 1;}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00135}00135\ }
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00136}00136\ \ \ \ \ \ \ \ \ \ \ \ \ memcpy(encoded,\ val\_start,\ val\_len);}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00137}00137\ \ \ \ \ \ \ \ \ \ \ \ \ encoded[val\_len]\ =\ \textcolor{charliteral}{'\(\backslash\)0'};}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00138}00138\ }
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00139}00139\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{wifi_8c_a3183361e8dc52b9c47fed54863439d4d}{url\_decode}}(dest,\ encoded);}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00140}00140\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00141}00141\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00142}00142\ }
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00143}00143\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Ir\ al\ siguiente\ par\ key=value}}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00144}00144\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *amp\ =\ strchr(eq\ +\ 1,\ \textcolor{charliteral}{'\&'});}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00145}00145\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!amp)\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00146}00146\ \ \ \ \ \ \ \ \ p\ =\ amp\ +\ 1;}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00147}00147\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00148}00148\ }
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00149}00149\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00150}00150\ \}}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00151}00151\ }
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00152}\mbox{\hyperlink{wifi_8c_ad8bb541f65016944ecd059dc8e08f531}{00152}}\ \textcolor{keyword}{static}\ esp\_err\_t\ \mbox{\hyperlink{wifi_8c_ad8bb541f65016944ecd059dc8e08f531}{root\_get\_handler}}(httpd\_req\_t\ *req)\ \{}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00153}00153\ \ \ \ \ httpd\_resp\_set\_type(req,\ \textcolor{stringliteral}{"{}text/html"{}});}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00154}00154\ \ \ \ \ httpd\_resp\_send(req,\ \mbox{\hyperlink{form_8c_a9c30aca44c8e1e99d9c0346902ea6d38}{HTML\_FORM}},\ HTTPD\_RESP\_USE\_STRLEN);}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00155}00155\ \ \ \ \ \textcolor{keywordflow}{return}\ ESP\_OK;}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00156}00156\ \}}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00157}00157\ }
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00158}\mbox{\hyperlink{wifi_8c_a7803a9e01b15f01009c423b6e8ebc91a}{00158}}\ \textcolor{keyword}{static}\ esp\_err\_t\ \mbox{\hyperlink{wifi_8c_a7803a9e01b15f01009c423b6e8ebc91a}{save\_post\_handler}}(httpd\_req\_t\ *req)\ \{}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00159}00159\ \ \ \ \ \textcolor{keywordtype}{char}\ body[512];}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00160}00160\ \ \ \ \ \textcolor{keywordtype}{char}\ cmd[16]\ =\ \{0\};}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00161}00161\ }
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00162}00162\ \ \ \ \ \mbox{\hyperlink{structtime__settings___s_h1106__t}{time\_settings\_SH1106\_t}}\ time\_edit;}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00163}00163\ \ \ \ \ \mbox{\hyperlink{structseccurity__settings___s_h1106__t}{seccurity\_settings\_SH1106\_t}}\ seccurity\_edit;}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00164}00164\ \ \ \ \ \mbox{\hyperlink{structfrequency__settings___s_h1106__t}{frequency\_settings\_SH1106\_t}}\ frequency\_edit;}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00165}00165\ }
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00166}00166\ \ \ \ \ \textcolor{keywordflow}{if}\ (req-\/>content\_len\ >=\ \textcolor{keyword}{sizeof}(body))\ \{}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00167}00167\ \ \ \ \ \ \ \ \ ESP\_LOGW(\mbox{\hyperlink{adc_8c_a5a85b9c772bbeb480b209a3e6ea92b4c}{TAG}},\ \textcolor{stringliteral}{"{}Body\ demasiado\ grande\ (\%d)"{}},\ req-\/>content\_len);}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00168}00168\ \ \ \ \ \ \ \ \ httpd\_resp\_send\_err(req,\ HTTPD\_500\_INTERNAL\_SERVER\_ERROR,\ \textcolor{stringliteral}{"{}Body\ too\ large"{}});}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00169}00169\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ ESP\_FAIL;}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00170}00170\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00171}00171\ }
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00172}00172\ \ \ \ \ \textcolor{keywordtype}{int}\ received\ =\ httpd\_req\_recv(req,\ body,\ req-\/>content\_len);}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00173}00173\ \ \ \ \ \textcolor{keywordflow}{if}\ (received\ <=\ 0)\ \{}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00174}00174\ \ \ \ \ \ \ \ \ ESP\_LOGW(\mbox{\hyperlink{adc_8c_a5a85b9c772bbeb480b209a3e6ea92b4c}{TAG}},\ \textcolor{stringliteral}{"{}Error\ recibiendo\ body"{}});}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00175}00175\ \ \ \ \ \ \ \ \ httpd\_resp\_send\_err(req,\ HTTPD\_500\_INTERNAL\_SERVER\_ERROR,\ \textcolor{stringliteral}{"{}Receive\ error"{}});}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00176}00176\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ ESP\_FAIL;}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00177}00177\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00178}00178\ \ \ \ \ body[received]\ =\ \textcolor{charliteral}{'\(\backslash\)0'};}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00179}00179\ }
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00180}00180\ \ \ \ \ ESP\_LOGI(\mbox{\hyperlink{adc_8c_a5a85b9c772bbeb480b209a3e6ea92b4c}{TAG}},\ \textcolor{stringliteral}{"{}Body:\ \%s"{}},\ body);}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00181}00181\ }
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00182}00182\ \ \ \ \ \textcolor{keywordtype}{char}\ buf[64];}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00183}00183\ }
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00184}00184\ \ \ \ \ \textcolor{comment}{/*\ -\/-\/-\/-\/-\/-\/-\/-\/\ Leer\ parámetros\ -\/-\/-\/-\/-\/-\/-\/-\/\ */}}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00185}00185\ }
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00186}00186\ \ \ \ \ \textcolor{keywordtype}{int}\ frequency\ =\ 0,\ accel\ =\ 0,\ decel\ =\ 0,\ variation\ =\ 0;}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00187}00187\ \ \ \ \ \textcolor{keywordtype}{int}\ imax\ =\ 0,\ vmin\ =\ 0;}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00188}00188\ \ \ \ \ \textcolor{keywordtype}{char}\ variation\_str[16]\ =\ \{0\};}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00189}00189\ \ \ \ \ \textcolor{keywordtype}{char}\ sys\_time\_str[16]\ =\ \{0\};}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00190}00190\ \ \ \ \ \textcolor{keywordtype}{char}\ start\_time\_str[16]\ =\ \{0\};}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00191}00191\ \ \ \ \ \textcolor{keywordtype}{char}\ stop\_time\_str[16]\ =\ \{0\};}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00192}00192\ }
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00193}00193\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{wifi_8c_aebcef2c9ac87ea89e0eaed0cb99583e2}{get\_param\_value}}(body,\ \textcolor{stringliteral}{"{}frequency"{}},\ buf,\ \textcolor{keyword}{sizeof}(buf)))\ \{}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00194}00194\ \ \ \ \ \ \ \ \ frequency\ =\ atoi(buf);}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00195}00195\ \ \ \ \ \ \ \ \ ESP\_LOGI(\mbox{\hyperlink{adc_8c_a5a85b9c772bbeb480b209a3e6ea92b4c}{TAG}},\ \textcolor{stringliteral}{"{}Frecuencia:\ \%d"{}},\ frequency);}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00196}00196\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00197}00197\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{wifi_8c_aebcef2c9ac87ea89e0eaed0cb99583e2}{get\_param\_value}}(body,\ \textcolor{stringliteral}{"{}accel"{}},\ buf,\ \textcolor{keyword}{sizeof}(buf)))\ \{}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00198}00198\ \ \ \ \ \ \ \ \ accel\ =\ atoi(buf);}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00199}00199\ \ \ \ \ \ \ \ \ ESP\_LOGI(\mbox{\hyperlink{adc_8c_a5a85b9c772bbeb480b209a3e6ea92b4c}{TAG}},\ \textcolor{stringliteral}{"{}Aceleración:\ \%d"{}},\ accel);}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00200}00200\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00201}00201\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{wifi_8c_aebcef2c9ac87ea89e0eaed0cb99583e2}{get\_param\_value}}(body,\ \textcolor{stringliteral}{"{}decel"{}},\ buf,\ \textcolor{keyword}{sizeof}(buf)))\ \{}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00202}00202\ \ \ \ \ \ \ \ \ decel\ =\ atoi(buf);}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00203}00203\ \ \ \ \ \ \ \ \ ESP\_LOGI(\mbox{\hyperlink{adc_8c_a5a85b9c772bbeb480b209a3e6ea92b4c}{TAG}},\ \textcolor{stringliteral}{"{}Desaceleración:\ \%d"{}},\ decel);}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00204}00204\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00205}00205\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{wifi_8c_aebcef2c9ac87ea89e0eaed0cb99583e2}{get\_param\_value}}(body,\ \textcolor{stringliteral}{"{}imax"{}},\ buf,\ \textcolor{keyword}{sizeof}(buf)))\ \{}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00206}00206\ \ \ \ \ \ \ \ \ imax\ =\ atoi(buf);}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00207}00207\ \ \ \ \ \ \ \ \ ESP\_LOGI(\mbox{\hyperlink{adc_8c_a5a85b9c772bbeb480b209a3e6ea92b4c}{TAG}},\ \textcolor{stringliteral}{"{}Corriente\ maxima:\ \%d"{}},\ imax);}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00208}00208\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00209}00209\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{wifi_8c_aebcef2c9ac87ea89e0eaed0cb99583e2}{get\_param\_value}}(body,\ \textcolor{stringliteral}{"{}vmin"{}},\ buf,\ \textcolor{keyword}{sizeof}(buf)))\ \{}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00210}00210\ \ \ \ \ \ \ \ \ vmin\ =\ atoi(buf);}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00211}00211\ \ \ \ \ \ \ \ \ ESP\_LOGI(\mbox{\hyperlink{adc_8c_a5a85b9c772bbeb480b209a3e6ea92b4c}{TAG}},\ \textcolor{stringliteral}{"{}Tension\ minima:\ \%d"{}},\ vmin);}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00212}00212\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00213}00213\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{wifi_8c_aebcef2c9ac87ea89e0eaed0cb99583e2}{get\_param\_value}}(body,\ \textcolor{stringliteral}{"{}variation\_str"{}},\ variation\_str,\ \textcolor{keyword}{sizeof}(variation\_str)))\ \{}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00214}00214\ \ \ \ \ \ \ \ \ ESP\_LOGI(\mbox{\hyperlink{adc_8c_a5a85b9c772bbeb480b209a3e6ea92b4c}{TAG}},\ \textcolor{stringliteral}{"{}Variacion\ de\ entradas\ \%s"{}},\ variation\_str);}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00215}00215\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\ strcmp(variation\_str,\ \textcolor{stringliteral}{"{}cuadratica"{}})\ ==\ 0\ )\ \{}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00216}00216\ \ \ \ \ \ \ \ \ \ \ \ \ variation\ =\ 1;}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00217}00217\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00218}00218\ \ \ \ \ \ \ \ \ \ \ \ \ variation\ =\ 2;}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00219}00219\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00220}00220\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ variation\_str\ =\ "{}linear"{}\ o\ "{}quadratic"{}}}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00221}00221\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00222}00222\ \ \ \ \ \mbox{\hyperlink{wifi_8c_aebcef2c9ac87ea89e0eaed0cb99583e2}{get\_param\_value}}(body,\ \textcolor{stringliteral}{"{}sys\_time"{}},\ \ \ sys\_time\_str,\ \ \ \textcolor{keyword}{sizeof}(sys\_time\_str));}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00223}00223\ \ \ \ \ \mbox{\hyperlink{wifi_8c_aebcef2c9ac87ea89e0eaed0cb99583e2}{get\_param\_value}}(body,\ \textcolor{stringliteral}{"{}start\_time"{}},\ start\_time\_str,\ \textcolor{keyword}{sizeof}(start\_time\_str));}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00224}00224\ \ \ \ \ \mbox{\hyperlink{wifi_8c_aebcef2c9ac87ea89e0eaed0cb99583e2}{get\_param\_value}}(body,\ \textcolor{stringliteral}{"{}stop\_time"{}},\ \ stop\_time\_str,\ \ \textcolor{keyword}{sizeof}(stop\_time\_str));}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00225}00225\ }
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00226}00226\ \ \ \ \ \textcolor{comment}{/*\ -\/-\/-\/-\/-\/-\/-\/-\/\ Parsear\ horas\ -\/-\/-\/-\/-\/-\/-\/-\/\ */}}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00227}00227\ }
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00228}00228\ \ \ \ \ \textcolor{keywordtype}{int}\ sys\_h=0,\ sys\_m=0,\ sys\_s=0;}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00229}00229\ \ \ \ \ \textcolor{keywordtype}{int}\ start\_h=0,\ start\_m=0;}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00230}00230\ \ \ \ \ \textcolor{keywordtype}{int}\ stop\_h=0,\ stop\_m=0;}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00231}00231\ }
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00232}00232\ \ \ \ \ \textcolor{keywordflow}{if}\ (sscanf(sys\_time\_str,\ \textcolor{stringliteral}{"{}\%2d:\%2d:\%2d"{}},\ \&sys\_h,\ \&sys\_m,\ \&sys\_s)\ !=\ 3)\ \{}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00233}00233\ \ \ \ \ \ \ \ \ ESP\_LOGW(\mbox{\hyperlink{adc_8c_a5a85b9c772bbeb480b209a3e6ea92b4c}{TAG}},\ \textcolor{stringliteral}{"{}Hora\ de\ sistema\ inválida:\ \%s"{}},\ sys\_time\_str);}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00234}00234\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00235}00235\ \ \ \ \ \textcolor{keywordflow}{if}\ (sscanf(start\_time\_str,\ \textcolor{stringliteral}{"{}\%2d:\%2d"{}},\ \&start\_h,\ \&start\_m)\ !=\ 2)\ \{}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00236}00236\ \ \ \ \ \ \ \ \ ESP\_LOGW(\mbox{\hyperlink{adc_8c_a5a85b9c772bbeb480b209a3e6ea92b4c}{TAG}},\ \textcolor{stringliteral}{"{}Hora\ de\ arranque\ inválida:\ \%s"{}},\ start\_time\_str);}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00237}00237\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00238}00238\ \ \ \ \ \textcolor{keywordflow}{if}\ (sscanf(stop\_time\_str,\ \textcolor{stringliteral}{"{}\%2d:\%2d"{}},\ \&stop\_h,\ \&stop\_m)\ !=\ 2)\ \{}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00239}00239\ \ \ \ \ \ \ \ \ ESP\_LOGW(\mbox{\hyperlink{adc_8c_a5a85b9c772bbeb480b209a3e6ea92b4c}{TAG}},\ \textcolor{stringliteral}{"{}Hora\ de\ parada\ inválida:\ \%s"{}},\ stop\_time\_str);}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00240}00240\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00241}00241\ \ \ \ \ ESP\_LOGI(\mbox{\hyperlink{adc_8c_a5a85b9c772bbeb480b209a3e6ea92b4c}{TAG}},\ \textcolor{stringliteral}{"{}Hora\ de\ sistema:\ \%02d:\%02d:\%02d"{}},\ sys\_h,\ sys\_m,\ sys\_s);}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00242}00242\ \ \ \ \ ESP\_LOGI(\mbox{\hyperlink{adc_8c_a5a85b9c772bbeb480b209a3e6ea92b4c}{TAG}},\ \textcolor{stringliteral}{"{}Hora\ de\ arranque:\ \%02d:\%02d"{}},\ start\_h,\ start\_m);}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00243}00243\ \ \ \ \ ESP\_LOGI(\mbox{\hyperlink{adc_8c_a5a85b9c772bbeb480b209a3e6ea92b4c}{TAG}},\ \textcolor{stringliteral}{"{}Hora\ de\ parada:\ \%02d:\%02d"{}},\ stop\_h,\ stop\_m);}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00244}00244\ }
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00245}00245\ }
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00246}00246\ \ \ \ \ \textcolor{keyword}{struct\ }tm\ time\_system;}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00247}00247\ \ \ \ \ time\_system.tm\_hour\ =\ sys\_h;}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00248}00248\ \ \ \ \ time\_system.tm\_min\ =\ sys\_m;}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00249}00249\ \ \ \ \ time\_system.tm\_sec\ =\ sys\_s;}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00250}00250\ \ \ \ \ \textcolor{keyword}{struct\ }tm\ \mbox{\hyperlink{rtc_8c_a4b2b47c8b14e716db2bb270503eb09d2}{time\_start}};}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00251}00251\ \ \ \ \ \mbox{\hyperlink{rtc_8c_a4b2b47c8b14e716db2bb270503eb09d2}{time\_start}}.tm\_hour\ =\ start\_h;}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00252}00252\ \ \ \ \ \mbox{\hyperlink{rtc_8c_a4b2b47c8b14e716db2bb270503eb09d2}{time\_start}}.tm\_min\ =\ start\_m;}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00253}00253\ \ \ \ \ \textcolor{keyword}{struct\ }tm\ \mbox{\hyperlink{rtc_8c_a12c22a2f47ab452be111d558be82ac3d}{time\_stop}};}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00254}00254\ \ \ \ \ \mbox{\hyperlink{rtc_8c_a12c22a2f47ab452be111d558be82ac3d}{time\_stop}}.tm\_hour\ =\ stop\_h;}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00255}00255\ \ \ \ \ \mbox{\hyperlink{rtc_8c_a12c22a2f47ab452be111d558be82ac3d}{time\_stop}}.tm\_min\ =\ stop\_m;}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00256}00256\ }
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00257}00257\ \ \ \ \ frequency\_edit.\mbox{\hyperlink{structfrequency__settings___s_h1106__t_a189eb09594475537504d50c37e699723}{frequency\_settings}}.\mbox{\hyperlink{structfrequency__settings__t_a926d6368e65c23d77658fd6fd2c08af9}{freq\_regime}}\ =\ frequency;}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00258}00258\ \ \ \ \ frequency\_edit.\mbox{\hyperlink{structfrequency__settings___s_h1106__t_a189eb09594475537504d50c37e699723}{frequency\_settings}}.\mbox{\hyperlink{structfrequency__settings__t_a44e11b804280aecf19f944765588d26f}{acceleration}}\ =\ accel;}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00259}00259\ \ \ \ \ frequency\_edit.\mbox{\hyperlink{structfrequency__settings___s_h1106__t_a189eb09594475537504d50c37e699723}{frequency\_settings}}.\mbox{\hyperlink{structfrequency__settings__t_a8d753b012e5099230395ba6421d5d35b}{desacceleration}}\ =\ decel;}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00260}00260\ \ \ \ \ frequency\_edit.\mbox{\hyperlink{structfrequency__settings___s_h1106__t_a189eb09594475537504d50c37e699723}{frequency\_settings}}.\mbox{\hyperlink{structfrequency__settings__t_adbc9bfdd34cf261290d0c07e20756985}{input\_variable}}\ =\ variation;}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00261}00261\ }
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00262}00262\ \ \ \ \ seccurity\_edit.\mbox{\hyperlink{structseccurity__settings___s_h1106__t_a04821faac59bba131aeba433212a6b2d}{seccurity\_settings}}.\mbox{\hyperlink{structseccurity__settings__t_a69f28b5a90c9b33472fb9b8e7d530cb1}{ibus\_max}}\ =\ imax;}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00263}00263\ \ \ \ \ seccurity\_edit.\mbox{\hyperlink{structseccurity__settings___s_h1106__t_a04821faac59bba131aeba433212a6b2d}{seccurity\_settings}}.\mbox{\hyperlink{structseccurity__settings__t_a58033d9c9f897d33e98d9686d7cf78b5}{vbus\_min}}\ =\ vmin;}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00264}00264\ }
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00265}00265\ \ \ \ \ time\_edit.\mbox{\hyperlink{structtime__settings___s_h1106__t_a0536e0cc003aac0cf284f5b7851afdfc}{time\_settings}}.\mbox{\hyperlink{structtime__settings__t_a469780047b4f94bbf6c949912d70ed8a}{time\_system}}\ =\ \&time\_system;}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00266}00266\ \ \ \ \ time\_edit.\mbox{\hyperlink{structtime__settings___s_h1106__t_a0536e0cc003aac0cf284f5b7851afdfc}{time\_settings}}.\mbox{\hyperlink{structtime__settings__t_a3dce91f42d172e8fccc4647d8f2a3aa8}{time\_start}}\ =\ \&\mbox{\hyperlink{rtc_8c_a4b2b47c8b14e716db2bb270503eb09d2}{time\_start}};}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00267}00267\ \ \ \ \ time\_edit.\mbox{\hyperlink{structtime__settings___s_h1106__t_a0536e0cc003aac0cf284f5b7851afdfc}{time\_settings}}.\mbox{\hyperlink{structtime__settings__t_a6549e561c2961a7bb3d1d8dd13c10e3f}{time\_stop}}\ =\ \&\mbox{\hyperlink{rtc_8c_a12c22a2f47ab452be111d558be82ac3d}{time\_stop}};}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00268}00268\ }
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00269}00269\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{wifi_8c_aebcef2c9ac87ea89e0eaed0cb99583e2}{get\_param\_value}}(body,\ \textcolor{stringliteral}{"{}cmd"{}},\ cmd,\ \textcolor{keyword}{sizeof}(cmd)))\ \{}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00270}00270\ \ \ \ \ \ \ \ \ ESP\_LOGI(\mbox{\hyperlink{adc_8c_a5a85b9c772bbeb480b209a3e6ea92b4c}{TAG}},\ \textcolor{stringliteral}{"{}Comando:\ \%s"{}},\ cmd);}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00271}00271\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (strcmp(cmd,\ \textcolor{stringliteral}{"{}save"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00272}00272\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{display_8c_a9176ac5e0c10e356605c472cadba998c}{system\_variables\_save}}(\&frequency\_edit,\ \&time\_edit,\ \&seccurity\_edit);}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00273}00273\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (strcmp(cmd,\ \textcolor{stringliteral}{"{}start"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00274}00274\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{sys_control_8c_aba4a84160e22ceea0cedd0ddcd454af4}{SystemEventPost}}(\mbox{\hyperlink{_l_v_f_v__system_8h_ab7a290ebff8e2a3230e8085ee87d4796a63785524fddc6173ea49aacebd1ba9b4}{START\_PRESSED}});}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00275}00275\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (strcmp(cmd,\ \textcolor{stringliteral}{"{}stop"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00276}00276\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{sys_control_8c_aba4a84160e22ceea0cedd0ddcd454af4}{SystemEventPost}}(\mbox{\hyperlink{_l_v_f_v__system_8h_ab7a290ebff8e2a3230e8085ee87d4796aa9aca1a320269de9561c234df472939c}{STOP\_PRESSED}});}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00277}00277\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00278}00278\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00279}00279\ }
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00280}00280\ \ \ \ \ \textcolor{comment}{/*\ -\/-\/-\/-\/-\/-\/-\/-\/\ Respuesta\ al\ navegador\ -\/-\/-\/-\/-\/-\/-\/-\/\ */}}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00281}00281\ }
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00282}00282\ \ \ \ \ httpd\_resp\_set\_type(req,\ \textcolor{stringliteral}{"{}text/html"{}});}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00283}00283\ \ \ \ \ httpd\_resp\_send(req,\ \mbox{\hyperlink{form_8c_a9c30aca44c8e1e99d9c0346902ea6d38}{HTML\_FORM}},\ HTTPD\_RESP\_USE\_STRLEN);}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00284}00284\ }
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00285}00285\ \ \ \ \ \textcolor{keywordflow}{return}\ ESP\_OK;}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00286}00286\ \}}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00287}00287\ }
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00288}\mbox{\hyperlink{wifi_8c_aa405dbf500a1f511f559e1e87efff9da}{00288}}\ httpd\_handle\_t\ \mbox{\hyperlink{wifi_8c_aa405dbf500a1f511f559e1e87efff9da}{start\_webserver}}(\textcolor{keywordtype}{void})\ \{}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00289}00289\ \ \ \ \ httpd\_config\_t\ config\ =\ HTTPD\_DEFAULT\_CONFIG();}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00290}00290\ \ \ \ \ config.server\_port\ =\ 80;}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00291}00291\ }
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00292}00292\ \ \ \ \ httpd\_handle\_t\ server\ =\ NULL;}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00293}00293\ \ \ \ \ \textcolor{keywordflow}{if}\ (httpd\_start(\&server,\ \&config)\ ==\ ESP\_OK)\ \{}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00294}00294\ \ \ \ \ \ \ \ \ httpd\_uri\_t\ root\_uri\ =\ \{}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00295}00295\ \ \ \ \ \ \ \ \ \ \ \ \ .uri\ \ \ \ \ \ =\ \textcolor{stringliteral}{"{}/"{}},}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00296}00296\ \ \ \ \ \ \ \ \ \ \ \ \ .method\ \ \ =\ HTTP\_GET,}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00297}00297\ \ \ \ \ \ \ \ \ \ \ \ \ .handler\ \ =\ \mbox{\hyperlink{wifi_8c_ad8bb541f65016944ecd059dc8e08f531}{root\_get\_handler}},}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00298}00298\ \ \ \ \ \ \ \ \ \ \ \ \ .user\_ctx\ =\ NULL}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00299}00299\ \ \ \ \ \ \ \ \ \};}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00300}00300\ \ \ \ \ \ \ \ \ httpd\_register\_uri\_handler(server,\ \&root\_uri);}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00301}00301\ }
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00302}00302\ \ \ \ \ \ \ \ \ httpd\_uri\_t\ save\_uri\ =\ \{}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00303}00303\ \ \ \ \ \ \ \ \ \ \ \ \ .uri\ \ \ \ \ \ =\ \textcolor{stringliteral}{"{}/save"{}},}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00304}00304\ \ \ \ \ \ \ \ \ \ \ \ \ .method\ \ \ =\ HTTP\_POST,}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00305}00305\ \ \ \ \ \ \ \ \ \ \ \ \ .handler\ \ =\ \mbox{\hyperlink{wifi_8c_a7803a9e01b15f01009c423b6e8ebc91a}{save\_post\_handler}},}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00306}00306\ \ \ \ \ \ \ \ \ \ \ \ \ .user\_ctx\ =\ NULL}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00307}00307\ \ \ \ \ \ \ \ \ \};}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00308}00308\ \ \ \ \ \ \ \ \ httpd\_register\_uri\_handler(server,\ \&save\_uri);}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00309}00309\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00310}00310\ \ \ \ \ \textcolor{keywordflow}{return}\ server;}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00311}00311\ \}}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00312}00312\ }
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00313}\mbox{\hyperlink{wifi_8c_a4a2bc421f17a5713e35165034943cea3}{00313}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{wifi_8c_a4a2bc421f17a5713e35165034943cea3}{wifi\_init\_softap}}(\textcolor{keywordtype}{void})\ \{}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00314}00314\ \ \ \ \ ESP\_ERROR\_CHECK(esp\_netif\_init());}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00315}00315\ \ \ \ \ ESP\_ERROR\_CHECK(esp\_event\_loop\_create\_default());}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00316}00316\ \ \ \ \ esp\_netif\_create\_default\_wifi\_ap();}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00317}00317\ }
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00318}00318\ \ \ \ \ wifi\_init\_config\_t\ cfg\ =\ WIFI\_INIT\_CONFIG\_DEFAULT();}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00319}00319\ \ \ \ \ ESP\_ERROR\_CHECK(esp\_wifi\_init(\&cfg));}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00320}00320\ }
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00321}00321\ \ \ \ \ wifi\_config\_t\ wifi\_config\ =\ \{}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00322}00322\ \ \ \ \ \ \ \ \ .ap\ =\ \{}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00323}00323\ \ \ \ \ \ \ \ \ \ \ \ \ .ssid\ =\ \textcolor{stringliteral}{"{}LVFV\_2025"{}},}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00324}00324\ \ \ \ \ \ \ \ \ \ \ \ \ .ssid\_len\ =\ 0,}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00325}00325\ \ \ \ \ \ \ \ \ \ \ \ \ .channel\ =\ 1,}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00326}00326\ \ \ \ \ \ \ \ \ \ \ \ \ .password\ =\ \textcolor{stringliteral}{"{}LVFV\_2025"{}},}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00327}00327\ \ \ \ \ \ \ \ \ \ \ \ \ .max\_connection\ =\ 1,}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00328}00328\ \ \ \ \ \ \ \ \ \ \ \ \ .authmode\ =\ WIFI\_AUTH\_WPA\_WPA2\_PSK}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00329}00329\ \ \ \ \ \ \ \ \ \},}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00330}00330\ \ \ \ \ \};}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00331}00331\ \ \ \ \ \textcolor{keywordflow}{if}\ (strlen((\textcolor{keywordtype}{char}\ *)wifi\_config.ap.password)\ ==\ 0)\ \{}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00332}00332\ \ \ \ \ \ \ \ \ wifi\_config.ap.authmode\ =\ WIFI\_AUTH\_OPEN;}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00333}00333\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00334}00334\ }
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00335}00335\ \ \ \ \ ESP\_ERROR\_CHECK(esp\_wifi\_set\_mode(WIFI\_MODE\_AP));}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00336}00336\ \ \ \ \ ESP\_ERROR\_CHECK(esp\_wifi\_set\_config(WIFI\_IF\_AP,\ \&wifi\_config));}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00337}00337\ \ \ \ \ ESP\_ERROR\_CHECK(esp\_wifi\_start());}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00338}00338\ }
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00339}00339\ \ \ \ \ ESP\_LOGI(\mbox{\hyperlink{adc_8c_a5a85b9c772bbeb480b209a3e6ea92b4c}{TAG}},\ \textcolor{stringliteral}{"{}AP\ iniciado.\ SSID:\ \%s,\ pass:\ \%s"{}},\ wifi\_config.ap.ssid,\ wifi\_config.ap.password);}
\DoxyCodeLine{\Hypertarget{wifi_8c_source_l00340}00340\ \}}

\end{DoxyCode}
