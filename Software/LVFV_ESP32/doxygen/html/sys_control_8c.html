<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="es">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.15.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Low Voltage Variable Frequency Drive: Referencia del archivo C:/Users/User/LVFV_ESP32/main/system/sysControl.c</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="DoxyPic.jpeg"/></td>
  <td id="projectalign">
   <div id="projectname">Low Voltage Variable Frequency Drive<span id="projectnumber">&#160;2.1</span>
   </div>
   <div id="projectbrief">Proyecto final Andrenacci-Carra 2025. Variador de frecuencia de motor trifásico 1/3HP utilizando 12V de contínua como fuente de entrada de tensión.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generado por Doxygen 1.15.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Buscar',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('sys_control_8c.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Cargando...</div>
<div class="SRStatus" id="Searching">Buscando...</div>
<div class="SRStatus" id="NoMatches">Nada coincide</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">Referencia del archivo sysControl.c</div></div>
</div><!--header-->
<div class="contents">

<p>Archivo de funciones que controlan el sistema físico a través del puerto SPI contra el STM32. En función de las respuestas del STM32, es que se controlan las variables internas de sistema del ESP32.  
<a href="#details">Más...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &quot;esp_log.h&quot;</code><br />
<code>#include &quot;esp_err.h&quot;</code><br />
<code>#include &quot;freertos/FreeRTOS.h&quot;</code><br />
<code>#include &quot;freertos/task.h&quot;</code><br />
<code>#include &quot;freertos/queue.h&quot;</code><br />
<code>#include &quot;driver/spi_master.h&quot;</code><br />
<code>#include &quot;driver/gpio.h&quot;</code><br />
<code>#include &quot;<a class="el" href="io__control_8h_source.html">./io_control/io_control.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_l_v_f_v__system_8h_source.html">../LVFV_system.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="display_8h_source.html">./display/display.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="adc_8h_source.html">./adc/adc.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="sys_admin_8h_source.html">./SysAdmin.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="sys_control_8h_source.html">./SysControl.h</a>&quot;</code><br />
</div>
<p><a href="sys_control_8c_source.html">Ir al código fuente de este archivo.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-define-members" class="groupheader"><a id="define-members" name="define-members"></a>
defines</h2></td></tr>
<tr class="memitem:a6c332c3f862c9e17cb09b32c73516a4a" id="r_a6c332c3f862c9e17cb09b32c73516a4a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6c332c3f862c9e17cb09b32c73516a4a">PIN_NUM_CS</a>&#160;&#160;&#160;12                      /** @def PIN_NUM_CS @brief Chip select del SPI para comunicación con el STM32. IO12 */</td></tr>
<tr class="memitem:a756bcaa6e44d1879623a058849c66fbb" id="r_a756bcaa6e44d1879623a058849c66fbb"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a756bcaa6e44d1879623a058849c66fbb">PIN_NUM_CLK</a>&#160;&#160;&#160;14                      /** @def PIN_NUM_CLK @brief Clock del SPI para comunicación con el STM32. IO14 */</td></tr>
<tr class="memitem:a4ffa0949bfda52d9c7b37fcb148cbb53" id="r_a4ffa0949bfda52d9c7b37fcb148cbb53"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4ffa0949bfda52d9c7b37fcb148cbb53">PIN_NUM_MISO</a>&#160;&#160;&#160;26                      /** @def PIN_NUM_MISO @brief master input slave output del SPI para comunicación con el STM32. IO26 */</td></tr>
<tr class="memitem:a060569807a8819489e6a7b4ee17ad67b" id="r_a060569807a8819489e6a7b4ee17ad67b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a060569807a8819489e6a7b4ee17ad67b">PIN_NUM_MOSI</a>&#160;&#160;&#160;25                      /** @def PIN_NUM_MOSI @brief master output slave input del SPI para comunicación con el STM32. IO25 */</td></tr>
<tr class="memitem:abdefebebc9a687a44d211bff0a7e2ba7" id="r_abdefebebc9a687a44d211bff0a7e2ba7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abdefebebc9a687a44d211bff0a7e2ba7">SPI_HOST_USED</a>&#160;&#160;&#160;SPI2_HOST               /** @def SPI_HOST_USED @brief don't know */</td></tr>
<tr class="memitem:a9572e15a5d84776a6096a9b803605c2a" id="r_a9572e15a5d84776a6096a9b803605c2a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9572e15a5d84776a6096a9b803605c2a">SPI_CLOCK_HZ</a>&#160;&#160;&#160;1*1000*1000             /** @def SPI_CLOCK_HZ @brief Velocidad de clock: 1 MHz */</td></tr>
<tr class="memitem:a3f984b96b51ca55db0782a79a70afd0c" id="r_a3f984b96b51ca55db0782a79a70afd0c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3f984b96b51ca55db0782a79a70afd0c">SPI_QUEUE_TX_DEPTH</a>&#160;&#160;&#160;1                       /** @def SPI_QUEUE_TX_DEPTH @brief Profundidad de comandos para el puerto SPI */</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
Funciones</h2></td></tr>
<tr class="memitem:a2d9e6e1ddc0c0ac33b911451037f71cd" id="r_a2d9e6e1ddc0c0ac33b911451037f71cd"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="sys_control_8h.html#acdb815a404f9450379dae79745e5ccd9">SPI_Response</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2d9e6e1ddc0c0ac33b911451037f71cd">SPI_SendRequest</a> (<a class="el" href="structspi__cmd__item__t.html">spi_cmd_item_t</a> *spi_cmd_item)</td></tr>
<tr class="memdesc:a2d9e6e1ddc0c0ac33b911451037f71cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Envía el comando configurado en <code class="param">spi_cmd_item-&gt;request</code> con el argumento <code class="param">spi_cmd_item-&gt;setValue</code> en caso de ser necesario y obtiene los datos que responde el STM32 en <code class="param">spi_cmd_item-&gt;getValue</code> si corresponde.  <br /></td></tr>
<tr class="memitem:ad98df654b2d69b2699482f667045022e" id="r_ad98df654b2d69b2699482f667045022e"><td class="memItemLeft" align="right" valign="top">esp_err_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad98df654b2d69b2699482f667045022e">SPI_Init</a> (void)</td></tr>
<tr class="memdesc:ad98df654b2d69b2699482f667045022e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Inicializa el módulo SPI del ESP32.  <br /></td></tr>
<tr class="memitem:a50b899a34931236e1ec86c160983f167" id="r_a50b899a34931236e1ec86c160983f167"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a50b899a34931236e1ec86c160983f167">SPI_communication</a> (void *arg)</td></tr>
<tr class="memdesc:a50b899a34931236e1ec86c160983f167"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tarea que controla en arranque, parada y emergencia del sistema.  <br /></td></tr>
<tr class="memitem:aba4a84160e22ceea0cedd0ddcd454af4" id="r_aba4a84160e22ceea0cedd0ddcd454af4"><td class="memItemLeft" align="right" valign="top">esp_err_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aba4a84160e22ceea0cedd0ddcd454af4">SystemEventPost</a> (<a class="el" href="_l_v_f_v__system_8h.html#ab7a290ebff8e2a3230e8085ee87d4796">systemSignal_e</a> event)</td></tr>
<tr class="memdesc:aba4a84160e22ceea0cedd0ddcd454af4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encola comandos en la cola system_event_queue.  <br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-var-members" class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a5a85b9c772bbeb480b209a3e6ea92b4c" id="r_a5a85b9c772bbeb480b209a3e6ea92b4c"><td class="memItemLeft" align="right" valign="top">static const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5a85b9c772bbeb480b209a3e6ea92b4c">TAG</a> = &quot;sysControl&quot;</td></tr>
<tr class="memitem:afc30189060043a947849f1be03105b4c" id="r_afc30189060043a947849f1be03105b4c"><td class="memItemLeft" align="right" valign="top">QueueHandle_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afc30189060043a947849f1be03105b4c">system_event_queue</a> = NULL</td></tr>
<tr class="memitem:a805cfba6efbab00f398be9bc6a71ba7e" id="r_a805cfba6efbab00f398be9bc6a71ba7e"><td class="memItemLeft" align="right" valign="top">static spi_device_handle_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a805cfba6efbab00f398be9bc6a71ba7e">spi_handle</a> = NULL</td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Descripción detallada</h2>
<div class="textblock"><p>Archivo de funciones que controlan el sistema físico a través del puerto SPI contra el STM32. En función de las respuestas del STM32, es que se controlan las variables internas de sistema del ESP32. </p>
<dl class="section author"><dt>Autor</dt><dd>Andrenacci - Carra </dd></dl>
<dl class="section version"><dt>Versión</dt><dd>2.0 </dd></dl>
<dl class="section date"><dt>Fecha</dt><dd>2025-11-06 </dd></dl>

<p class="definition">Definición en el archivo <a class="el" href="sys_control_8c_source.html">sysControl.c</a>.</p>
</div><a name="doc-define-members" id="doc-define-members"></a><h2 id="header-doc-define-members" class="groupheader">Documentación de «define»</h2>
<a id="a756bcaa6e44d1879623a058849c66fbb" name="a756bcaa6e44d1879623a058849c66fbb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a756bcaa6e44d1879623a058849c66fbb">&#9670;&#160;</a></span>PIN_NUM_CLK</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PIN_NUM_CLK&#160;&#160;&#160;14                      /** @def PIN_NUM_CLK @brief Clock del SPI para comunicación con el STM32. IO14 */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definición en la línea <a class="el" href="sys_control_8c_source.html#l00031">31</a> del archivo <a class="el" href="sys_control_8c_source.html">sysControl.c</a>.</p>

</div>
</div>
<a id="a6c332c3f862c9e17cb09b32c73516a4a" name="a6c332c3f862c9e17cb09b32c73516a4a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c332c3f862c9e17cb09b32c73516a4a">&#9670;&#160;</a></span>PIN_NUM_CS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PIN_NUM_CS&#160;&#160;&#160;12                      /** @def PIN_NUM_CS @brief Chip select del SPI para comunicación con el STM32. IO12 */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definición en la línea <a class="el" href="sys_control_8c_source.html#l00030">30</a> del archivo <a class="el" href="sys_control_8c_source.html">sysControl.c</a>.</p>

</div>
</div>
<a id="a4ffa0949bfda52d9c7b37fcb148cbb53" name="a4ffa0949bfda52d9c7b37fcb148cbb53"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ffa0949bfda52d9c7b37fcb148cbb53">&#9670;&#160;</a></span>PIN_NUM_MISO</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PIN_NUM_MISO&#160;&#160;&#160;26                      /** @def PIN_NUM_MISO @brief master input slave output del SPI para comunicación con el STM32. IO26 */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definición en la línea <a class="el" href="sys_control_8c_source.html#l00032">32</a> del archivo <a class="el" href="sys_control_8c_source.html">sysControl.c</a>.</p>

</div>
</div>
<a id="a060569807a8819489e6a7b4ee17ad67b" name="a060569807a8819489e6a7b4ee17ad67b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a060569807a8819489e6a7b4ee17ad67b">&#9670;&#160;</a></span>PIN_NUM_MOSI</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PIN_NUM_MOSI&#160;&#160;&#160;25                      /** @def PIN_NUM_MOSI @brief master output slave input del SPI para comunicación con el STM32. IO25 */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definición en la línea <a class="el" href="sys_control_8c_source.html#l00033">33</a> del archivo <a class="el" href="sys_control_8c_source.html">sysControl.c</a>.</p>

</div>
</div>
<a id="a9572e15a5d84776a6096a9b803605c2a" name="a9572e15a5d84776a6096a9b803605c2a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9572e15a5d84776a6096a9b803605c2a">&#9670;&#160;</a></span>SPI_CLOCK_HZ</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SPI_CLOCK_HZ&#160;&#160;&#160;1*1000*1000             /** @def SPI_CLOCK_HZ @brief Velocidad de clock: 1 MHz */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definición en la línea <a class="el" href="sys_control_8c_source.html#l00037">37</a> del archivo <a class="el" href="sys_control_8c_source.html">sysControl.c</a>.</p>

</div>
</div>
<a id="abdefebebc9a687a44d211bff0a7e2ba7" name="abdefebebc9a687a44d211bff0a7e2ba7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abdefebebc9a687a44d211bff0a7e2ba7">&#9670;&#160;</a></span>SPI_HOST_USED</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SPI_HOST_USED&#160;&#160;&#160;SPI2_HOST               /** @def SPI_HOST_USED @brief don't know */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definición en la línea <a class="el" href="sys_control_8c_source.html#l00036">36</a> del archivo <a class="el" href="sys_control_8c_source.html">sysControl.c</a>.</p>

</div>
</div>
<a id="a3f984b96b51ca55db0782a79a70afd0c" name="a3f984b96b51ca55db0782a79a70afd0c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f984b96b51ca55db0782a79a70afd0c">&#9670;&#160;</a></span>SPI_QUEUE_TX_DEPTH</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SPI_QUEUE_TX_DEPTH&#160;&#160;&#160;1                       /** @def SPI_QUEUE_TX_DEPTH @brief Profundidad de comandos para el puerto SPI */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definición en la línea <a class="el" href="sys_control_8c_source.html#l00038">38</a> del archivo <a class="el" href="sys_control_8c_source.html">sysControl.c</a>.</p>

</div>
</div>
<a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Documentación de funciones</h2>
<a id="a50b899a34931236e1ec86c160983f167" name="a50b899a34931236e1ec86c160983f167"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50b899a34931236e1ec86c160983f167">&#9670;&#160;</a></span>SPI_communication()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SPI_communication </td>
          <td>(</td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>arg</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tarea que controla en arranque, parada y emergencia del sistema. </p>
<p>Espera comandos a través de la cola system_event_queue para evaluar si enviar comandos de start, stop, emergencia, cambios de velocidad, etc. Hace indirectamente el polling de las mediciones del ADC para evaluar si está en estado de emergencia o no.</p>
<dl class="params"><dt>Parámetros</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">arg</td><td>Sin uso </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definición en la línea <a class="el" href="sys_control_8c_source.html#l00186">186</a> del archivo <a class="el" href="sys_control_8c_source.html">sysControl.c</a>.</p>

</div>
</div>
<a id="ad98df654b2d69b2699482f667045022e" name="ad98df654b2d69b2699482f667045022e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad98df654b2d69b2699482f667045022e">&#9670;&#160;</a></span>SPI_Init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">esp_err_t SPI_Init </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Inicializa el módulo SPI del ESP32. </p>
<p>Con figura los pines PIN_NUM_CS en el pin IO12, PIN_NUM_CLK en el pin IO14, PIN_NUM_MISO en el pin IO26 y PIN_NUM_MOSI en el pin IO25; además configura el clock del SPI en 1MHz y tendrá solo un comando para encolar</p>
<dl class="section return"><dt>Devuelve</dt><dd><ul>
<li>ESP_ERR_INVALID_ARG Si la configuración es inválida. La combinación de los parámetros puede resultar inválida.</li>
<li>ESP_ERR_INVALID_STATE Si el host ya se encontraba en uso, si la fuente de clock es inviable o si el SPI no fue inicializado correctamente.</li>
<li>ESP_ERR_NOT_FOUND if there is no available DMA channel</li>
<li>ESP_ERR_NO_MEM Si no hay memoria suficiente para inicializar el módulo</li>
<li>ESP_OK si la configuración fue exitosa </li>
</ul>
</dd></dl>

<p class="definition">Definición en la línea <a class="el" href="sys_control_8c_source.html#l00155">155</a> del archivo <a class="el" href="sys_control_8c_source.html">sysControl.c</a>.</p>

</div>
</div>
<a id="a2d9e6e1ddc0c0ac33b911451037f71cd" name="a2d9e6e1ddc0c0ac33b911451037f71cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d9e6e1ddc0c0ac33b911451037f71cd">&#9670;&#160;</a></span>SPI_SendRequest()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="sys_control_8h.html#acdb815a404f9450379dae79745e5ccd9">SPI_Response</a> SPI_SendRequest </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structspi__cmd__item__t.html">spi_cmd_item_t</a> *</td>          <td class="paramname"><span class="paramname"><em>spi_cmd_item</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Envía el comando configurado en <code class="param">spi_cmd_item-&gt;request</code> con el argumento <code class="param">spi_cmd_item-&gt;setValue</code> en caso de ser necesario y obtiene los datos que responde el STM32 en <code class="param">spi_cmd_item-&gt;getValue</code> si corresponde. </p>
<p>El ESP32 debe enviar comandos en dos instancias. La primera envía el comando deseado por el usuario, se detiene la ejecución durante 200 mili segundos y luego se envía un nuevo comando para consultarle al STM32 si el comando enviado por el usuario fue recibido correctamente o no.</p>
<dl class="params"><dt>Parámetros</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">spi_cdm_item</td><td>Estrutura de datos con los parámetros necesarios para llevar a cabo la comunicación. Allí se almacena el comando, valores a enviar y valores recibidos.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Devuelve</dt><dd><ul>
<li>SPI_RESPONSE_ERR: Error en la transmisión del comando por problemas de inicialización del handler. El comando no sale del ESP32</li>
<li>SPI_RESPONSE_ERR_CMD_UNKNOWN: El comando enviado no está dentro los posibles</li>
<li>SPI_RESPONSE_ERR_MOVING: Se está intentando enviar un comando de start con el motor en movimiento</li>
<li>SPI_RESPONSE_ERR_NOT_MOVING: Se está intentando enviar un comando de stop con el motor detenido</li>
<li>SPI_RESPONSE_ERR_DATA_MISSING: Faltó enviar un dato dentro de la trama</li>
<li>SPI_RESPONSE_ERR_DATA_INVALID: Los datos enviados como argumento dentro del comando están fuera de rango</li>
<li>SPI_RESPONSE_OK: La comunicación entre ESP32 y STM32 fue exitosa </li>
</ul>
</dd></dl>

<p class="definition">Definición en la línea <a class="el" href="sys_control_8c_source.html#l00067">67</a> del archivo <a class="el" href="sys_control_8c_source.html">sysControl.c</a>.</p>

</div>
</div>
<a id="aba4a84160e22ceea0cedd0ddcd454af4" name="aba4a84160e22ceea0cedd0ddcd454af4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba4a84160e22ceea0cedd0ddcd454af4">&#9670;&#160;</a></span>SystemEventPost()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">esp_err_t SystemEventPost </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_l_v_f_v__system_8h.html#ab7a290ebff8e2a3230e8085ee87d4796">systemSignal_e</a></td>          <td class="paramname"><span class="paramname"><em>event</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Encola comandos en la cola system_event_queue. </p>
<dl class="params"><dt>Parámetros</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">event</td><td>Evento que se desea encolar en el sistema</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Devuelve</dt><dd><ul>
<li>pdTRUE Si el comando se posteó correctamente</li>
<li>Cualquier otra respuesta implica que la cola está llena </li>
</ul>
</dd></dl>

<p class="definition">Definición en la línea <a class="el" href="sys_control_8c_source.html#l00363">363</a> del archivo <a class="el" href="sys_control_8c_source.html">sysControl.c</a>.</p>

</div>
</div>
<a name="doc-var-members" id="doc-var-members"></a><h2 id="header-doc-var-members" class="groupheader">Documentación de variables</h2>
<a id="a805cfba6efbab00f398be9bc6a71ba7e" name="a805cfba6efbab00f398be9bc6a71ba7e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a805cfba6efbab00f398be9bc6a71ba7e">&#9670;&#160;</a></span>spi_handle</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">spi_device_handle_t spi_handle = NULL</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definición en la línea <a class="el" href="sys_control_8c_source.html#l00044">44</a> del archivo <a class="el" href="sys_control_8c_source.html">sysControl.c</a>.</p>

</div>
</div>
<a id="afc30189060043a947849f1be03105b4c" name="afc30189060043a947849f1be03105b4c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc30189060043a947849f1be03105b4c">&#9670;&#160;</a></span>system_event_queue</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">QueueHandle_t system_event_queue = NULL</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definición en la línea <a class="el" href="sys_control_8c_source.html#l00042">42</a> del archivo <a class="el" href="sys_control_8c_source.html">sysControl.c</a>.</p>

</div>
</div>
<a id="a5a85b9c772bbeb480b209a3e6ea92b4c" name="a5a85b9c772bbeb480b209a3e6ea92b4c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a85b9c772bbeb480b209a3e6ea92b4c">&#9670;&#160;</a></span>TAG</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const char* TAG = &quot;sysControl&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definición en la línea <a class="el" href="sys_control_8c_source.html#l00040">40</a> del archivo <a class="el" href="sys_control_8c_source.html">sysControl.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="dir_5c982d53a68cdbcd421152b4020263a9.html">main</a></li><li class="navelem"><a href="dir_4ebdb2553a3894a04487b5c1cfb0e048.html">system</a></li><li class="navelem"><a href="sys_control_8c.html">sysControl.c</a></li>
    <li class="footer">Generado por <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.15.0 </li>
  </ul>
</div>
</body>
</html>
